---
title: å®‰å…¨ç®¡ç†
description: å­¦ä¹ å¦‚ä½•ç®¡ç† Debian ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼ŒåŒ…æ‹¬ç”¨æˆ·è®¿é—®æ§åˆ¶ã€é˜²ç«å¢™é…ç½®ã€è‡ªåŠ¨æ›´æ–°å’Œå…¥ä¾µæ£€æµ‹ã€‚
---

# å®‰å…¨ç®¡ç†

ç¡®ä¿ Debian ç³»ç»Ÿçš„å®‰å…¨æ˜¯ç³»ç»Ÿç®¡ç†ä¸­çš„ä¸€é¡¹æ ¸å¿ƒä»»åŠ¡ã€‚æœ¬æŒ‡å—å°†ä»‹ç»å‡ ä¸ªå…³é”®é¢†åŸŸï¼Œå¸®åŠ©æ‚¨åŠ å›ºç³»ç»Ÿï¼Œé˜²èŒƒæ½œåœ¨å¨èƒã€‚

## ğŸ” ç”¨æˆ·ä¸è®¿é—®æ§åˆ¶

é™åˆ¶å¯¹ç³»ç»Ÿçš„è®¿é—®æ˜¯å®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿ã€‚

### å¼ºåˆ¶æ‰§è¡Œå¼ºå¯†ç ç­–ç•¥

ä½¿ç”¨ `libpam-pwquality` æ¨¡å—å¯ä»¥å¼ºåˆ¶ç”¨æˆ·åˆ›å»ºæ›´å®‰å…¨çš„å¯†ç ã€‚

1.  **å®‰è£…æ¨¡å—**:
    ```bash
    sudo apt update
    sudo apt install libpam-pwquality
    ```

2.  **é…ç½®ç­–ç•¥**:
    ç¼–è¾‘ `/etc/security/pwquality.conf` æ–‡ä»¶æ¥å®šä¹‰å¯†ç è§„åˆ™ã€‚
    ```ini
    # ç¤ºä¾‹é…ç½®ï¼š
    minlen = 10                  # æœ€å°é•¿åº¦ä¸º 10
    dcredit = -1                 # è‡³å°‘åŒ…å« 1 ä¸ªæ•°å­—
    ucredit = -1                 # è‡³å°‘åŒ…å« 1 ä¸ªå¤§å†™å­—æ¯
    lcredit = -1                 # è‡³å°‘åŒ…å« 1 ä¸ªå°å†™å­—æ¯
    ocredit = -1                 # è‡³å°‘åŒ…å« 1 ä¸ªç‰¹æ®Šå­—ç¬¦
    difok = 3                    # æ–°å¯†ç ä¸­è‡³å°‘æœ‰ 3 ä¸ªå­—ç¬¦ä¸æ—§å¯†ç ä¸åŒ
    ```

### SSH å®‰å…¨åŠ å›º

è¿œç¨‹è®¿é—®æœåŠ¡å™¨æœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯ SSHã€‚ä»¥ä¸‹æ˜¯ä¸€äº›åŠ å›ºå»ºè®®ï¼š

1.  **ç¼–è¾‘ SSH é…ç½®æ–‡ä»¶**:
    ```bash
    sudo nano /etc/ssh/sshd_config
    ```

2.  **æ¨èé…ç½®**:
    - **ç¦ç”¨ root ç™»å½•**: `PermitRootLogin no`
    - **ç¦ç”¨å¯†ç è®¤è¯ (æ¨èä½¿ç”¨å¯†é’¥)**: `PasswordAuthentication no`
    - **å¯ç”¨å…¬é’¥è®¤è¯**: `PubkeyAuthentication yes`
    - **æ›´æ”¹é»˜è®¤ç«¯å£ (å¯é€‰)**: `Port 2222`

3.  **é‡å¯ SSH æœåŠ¡**:
    ```bash
    sudo systemctl restart sshd
    ```

## ğŸ”¥ é˜²ç«å¢™é…ç½® (UFW)

Debian é»˜è®¤ä¸å¯ç”¨é˜²ç«å¢™ã€‚`UFW` (Uncomplicated Firewall) æ˜¯ä¸€ä¸ªç”¨æˆ·å‹å¥½çš„å‰ç«¯ï¼Œå¯ä»¥è½»æ¾ç®¡ç† `iptables`ã€‚

1.  **å®‰è£… UFW**:
    ```bash
    sudo apt install ufw
    ```

2.  **é…ç½®åŸºæœ¬è§„åˆ™**:
    ```bash
    sudo ufw default deny incoming   # æ‹’ç»æ‰€æœ‰å…¥ç«™è¿æ¥
    sudo ufw default allow outgoing  # å…è®¸æ‰€æœ‰å‡ºç«™è¿æ¥
    sudo ufw allow ssh               # å…è®¸ SSH è¿æ¥ (æˆ–è€…ä½ æ›´æ”¹çš„ç«¯å£)
    sudo ufw allow http              # å¦‚æœæ˜¯ Web æœåŠ¡å™¨ï¼Œå…è®¸ HTTP
    sudo ufw allow https             # å…è®¸ HTTPS
    ```

3.  **å¯ç”¨ UFW**:
    ```bash
    sudo ufw enable
    ```
    ç³»ç»Ÿä¼šè­¦å‘Šä½ è¿™å¯èƒ½ä¼šä¸­æ–­ç°æœ‰çš„ SSH è¿æ¥ï¼Œç¡®è®¤å³å¯ã€‚

4.  **æ£€æŸ¥çŠ¶æ€**:
    ```bash
    sudo ufw status verbose
    ```

## ğŸ”„ è‡ªåŠ¨å®‰å…¨æ›´æ–°

åŠæ—¶åº”ç”¨å®‰å…¨è¡¥ä¸è‡³å…³é‡è¦ã€‚`unattended-upgrades` å¯ä»¥è‡ªåŠ¨å®‰è£…å®‰å…¨æ›´æ–°ã€‚

1.  **å®‰è£…**:
    ```bash
    sudo apt install unattended-upgrades
    ```

2.  **å¯ç”¨**:
    è¿è¡Œé…ç½®å‘å¯¼ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªåŸºç¡€é…ç½®æ–‡ä»¶ã€‚
    ```bash
    sudo dpkg-reconfigure -plow unattended-upgrades
    ```
    åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­é€‰æ‹©â€œæ˜¯â€ã€‚

3.  **å¾®è°ƒé…ç½® (å¯é€‰)**:
    æ‚¨å¯ä»¥ç¼–è¾‘ `/etc/apt/apt.conf.d/50unattended-upgrades` æ–‡ä»¶ï¼Œä»¥è‡ªå®šä¹‰æ›´æ–°è¡Œä¸ºï¼Œä¾‹å¦‚å¯ç”¨è‡ªåŠ¨é‡å¯ã€‚

## ğŸ›¡ï¸ å…¥ä¾µé˜²æŠ¤ (Fail2Ban)

`Fail2Ban` å¯ä»¥ç›‘æ§æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶æ ¹æ®å¯ç–‘è¡Œä¸ºï¼ˆå¦‚å¤šæ¬¡å¤±è´¥çš„ç™»å½•å°è¯•ï¼‰è‡ªåŠ¨æ›´æ–°é˜²ç«å¢™è§„åˆ™æ¥å°ç¦ IP åœ°å€ã€‚

1.  **å®‰è£… Fail2Ban**:
    ```bash
    sudo apt install fail2ban
    ```

2.  **åˆ›å»ºæœ¬åœ°é…ç½®æ–‡ä»¶**:
    ä¸è¦ç›´æ¥ä¿®æ”¹ `.conf` æ–‡ä»¶ï¼Œè€Œåº”åˆ›å»º `.local` æ–‡ä»¶è¿›è¡Œè¦†ç›–ã€‚
    ```bash
    sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
    sudo nano /etc/fail2ban/jail.local
    ```

3.  **é…ç½® SSH é˜²æŠ¤**:
    åœ¨ `jail.local` ä¸­æ‰¾åˆ° `[sshd]` éƒ¨åˆ†ï¼Œå¹¶ç¡®ä¿ `enabled = true`ã€‚æ‚¨å¯ä»¥è°ƒæ•´ `maxretry` (æœ€å¤§å°è¯•æ¬¡æ•°) å’Œ `bantime` (å°ç¦æ—¶é•¿)ã€‚
    ```ini
    [sshd]
    enabled = true
    port    = ssh
    maxretry = 3
    bantime = 3600  # å°ç¦ 1 å°æ—¶
    ```

4.  **é‡å¯æœåŠ¡**:
    ```bash
    sudo systemctl restart fail2ban
    ```

## ğŸ“ æ—¥å¿—ç®¡ç†ä¸å®¡è®¡

å®šæœŸæ£€æŸ¥ç³»ç»Ÿæ—¥å¿—æ˜¯å‘ç°å¼‚å¸¸æ´»åŠ¨çš„å…³é”®ã€‚

- **ä½¿ç”¨ `journalctl` æŸ¥çœ‹æ—¥å¿—**:
  ```bash
  # æŸ¥çœ‹æ‰€æœ‰æ—¥å¿— (ä»æ—§åˆ°æ–°)
  journalctl

  # å®æ—¶ç›‘æ§æ—¥å¿—
  journalctl -f

  # æŸ¥çœ‹ç‰¹å®šæœåŠ¡çš„æ—¥å¿—ï¼Œä¾‹å¦‚ sshd
  journalctl -u sshd.service

  # æŸ¥çœ‹å†…æ ¸æ—¥å¿—
  journalctl -k
  ``` 