---
title: ç£ç›˜ä¸å­˜å‚¨ç®¡ç†
description: Debian 13 ç£ç›˜åˆ†åŒºã€æ–‡ä»¶ç³»ç»Ÿä¸å­˜å‚¨ç®¡ç†å®Œå…¨æŒ‡å—
---

# ç£ç›˜ä¸å­˜å‚¨ç®¡ç†

ç®¡ç†ç£ç›˜å’Œå­˜å‚¨æ˜¯ç³»ç»Ÿç®¡ç†çš„åŸºç¡€æŠ€èƒ½ã€‚æœ¬ç« å°†å¸¦ä½ äº†è§£ Linux çš„å­˜å‚¨ä½“ç³»ï¼Œä»æŸ¥çœ‹ç£ç›˜ä¿¡æ¯åˆ°åˆ†åŒºã€æ ¼å¼åŒ–ã€æŒ‚è½½ï¼Œå†åˆ° LVM å’Œç£ç›˜åŠ å¯†ç­‰è¿›é˜¶å†…å®¹ã€‚

## ğŸ’¿ å­˜å‚¨åŸºç¡€æ¦‚å¿µ

### å­˜å‚¨å±‚æ¬¡ç»“æ„

åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæ•°æ®ä»ç‰©ç†ç¡¬ç›˜åˆ°ç”¨æˆ·å¯ç”¨çš„ç›®å½•ï¼Œéœ€è¦ç»è¿‡å‡ ä¸ªå±‚æ¬¡çš„æŠ½è±¡ã€‚ç†è§£è¿™ä¸ªå±‚æ¬¡ç»“æ„æœ‰åŠ©äºä½ æŒæ¡åç»­æ‰€æœ‰æ“ä½œï¼š

```mermaid
flowchart LR
    A["ğŸ”© ç‰©ç†ç£ç›˜\n/dev/sda"] --> B["ğŸ“¦ åˆ†åŒº\n/dev/sda1"]
    B --> C["ğŸ“‚ æ–‡ä»¶ç³»ç»Ÿ\next4 / Btrfs"]
    C --> D["ğŸ“ æŒ‚è½½ç‚¹\n/home"]

    style A fill:#e1f5fe,stroke:#0288d1,color:#000
    style B fill:#f3e5f5,stroke:#7b1fa2,color:#000
    style C fill:#e8f5e9,stroke:#388e3c,color:#000
    style D fill:#fff3e0,stroke:#f57c00,color:#000
```

- **ç‰©ç†ç£ç›˜**ï¼šæœåŠ¡å™¨æˆ–ç”µè„‘ä¸­å®é™…å®‰è£…çš„ç¡¬ç›˜è®¾å¤‡ï¼Œå¦‚ `/dev/sda`ã€`/dev/nvme0n1`
- **åˆ†åŒº**ï¼šå°†ä¸€å—ç‰©ç†ç£ç›˜åˆ’åˆ†æˆå¤šä¸ªé€»è¾‘åŒºåŸŸï¼Œæ¯ä¸ªåˆ†åŒºç‹¬ç«‹ä½¿ç”¨
- **æ–‡ä»¶ç³»ç»Ÿ**ï¼šåˆ†åŒºä¸Šçš„æ•°æ®ç»„ç»‡æ–¹å¼ï¼Œå†³å®šäº†æ–‡ä»¶å¦‚ä½•å­˜å‚¨å’Œæ£€ç´¢
- **æŒ‚è½½ç‚¹**ï¼šå°†æ–‡ä»¶ç³»ç»Ÿ"æ¥å…¥"åˆ°ç›®å½•æ ‘ä¸­çš„æŸä¸ªä½ç½®ï¼Œç”¨æˆ·é€šè¿‡è¯¥ç›®å½•è®¿é—®æ•°æ®

### æ ¸å¿ƒæœ¯è¯­

| æœ¯è¯­ | è‹±æ–‡ | è¯´æ˜ | ç±»æ¯” |
|------|------|------|------|
| ç¡¬ç›˜ | Hard Disk / SSD | ç‰©ç†å­˜å‚¨è®¾å¤‡ | ä¸€æ ‹å¤§æ¥¼ |
| åˆ†åŒº | Partition | ç¡¬ç›˜ä¸Šåˆ’åˆ†çš„é€»è¾‘åŒºåŸŸ | å¤§æ¥¼é‡Œçš„æ¥¼å±‚ |
| æ–‡ä»¶ç³»ç»Ÿ | Filesystem | æ•°æ®åœ¨åˆ†åŒºä¸Šçš„ç»„ç»‡æ ¼å¼ | æ¥¼å±‚å†…çš„æˆ¿é—´å¸ƒå±€ |
| æŒ‚è½½ç‚¹ | Mount Point | æ–‡ä»¶ç³»ç»Ÿåœ¨ç›®å½•æ ‘ä¸­çš„æ¥å…¥ä½ç½® | è¿›å…¥æ¥¼å±‚çš„é—¨ç‰Œå· |
| å—è®¾å¤‡ | Block Device | å†…æ ¸ä¸­è¡¨ç¤ºå­˜å‚¨è®¾å¤‡çš„æŠ½è±¡ | å¤§æ¥¼çš„å»ºç­‘å›¾çº¸ |
| inode | inode | æ–‡ä»¶ç³»ç»Ÿä¸­è®°å½•æ–‡ä»¶å…ƒæ•°æ®çš„æ•°æ®ç»“æ„ | æ¯é—´æˆ¿çš„ç™»è®°å¡ |
| UUID | UUID | åˆ†åŒºçš„å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ | æ¯é—´æˆ¿çš„å”¯ä¸€ç¼–å· |
| GPT/MBR | GPT/MBR | åˆ†åŒºè¡¨æ ¼å¼ï¼ˆGPT ä¸ºç°ä»£æ ¼å¼ï¼‰ | å¤§æ¥¼çš„æ¥¼å±‚è§„åˆ’å›¾æ ‡å‡† |

### è®¾å¤‡å‘½åè§„åˆ™

Linux ä¸­ä¸åŒç±»å‹çš„ç£ç›˜æœ‰ä¸åŒçš„è®¾å¤‡åç§°ï¼š

```bash
# SATA / SCSI ç£ç›˜
/dev/sda        # ç¬¬ä¸€å— SATA ç£ç›˜
/dev/sda1       # ç¬¬ä¸€å— SATA ç£ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒº
/dev/sdb        # ç¬¬äºŒå— SATA ç£ç›˜

# NVMe å›ºæ€ç¡¬ç›˜
/dev/nvme0n1    # ç¬¬ä¸€å— NVMe ç£ç›˜
/dev/nvme0n1p1  # ç¬¬ä¸€å— NVMe ç£ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒº

# è™šæ‹Ÿç£ç›˜ï¼ˆè™šæ‹Ÿæœºä¸­å¸¸è§ï¼‰
/dev/vda        # ç¬¬ä¸€å— virtio ç£ç›˜
/dev/vda1       # ç¬¬ä¸€å— virtio ç£ç›˜çš„ç¬¬ä¸€ä¸ªåˆ†åŒº
```

## ğŸ” æŸ¥çœ‹ç£ç›˜ä¿¡æ¯

### å¸¸ç”¨å‘½ä»¤

```bash
# ä»¥æ ‘å½¢ç»“æ„åˆ—å‡ºæ‰€æœ‰å—è®¾å¤‡
lsblk

# åˆ—å‡ºå—è®¾å¤‡å¹¶æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿä¿¡æ¯
lsblk -f

# æŸ¥çœ‹æ‰€æœ‰ç£ç›˜çš„è¯¦ç»†åˆ†åŒºä¿¡æ¯
sudo fdisk -l

# æŸ¥çœ‹å„æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼ˆäººç±»å¯è¯»æ ¼å¼ï¼‰
df -h

# ä»…æ˜¾ç¤ºæœ¬åœ°ç‰©ç†ç£ç›˜çš„ä½¿ç”¨æƒ…å†µï¼ˆæ’é™¤ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼‰
df -h --type=ext4 --type=btrfs --type=xfs

# æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹å„å­ç›®å½•çš„å¤§å°
du -sh /home/user/*

# æŸ¥çœ‹æ‰€æœ‰åˆ†åŒºçš„ UUID å’Œæ–‡ä»¶ç³»ç»Ÿç±»å‹
sudo blkid

# æŸ¥çœ‹ç£ç›˜ SMART å¥åº·ä¿¡æ¯ï¼ˆéœ€è¦å®‰è£… smartmontoolsï¼‰
sudo smartctl -a /dev/sda
```

### lsblk è¾“å‡ºè§£è¯»

è¿è¡Œ `lsblk` åä½ ä¼šçœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š

```
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
sda           8:0    0 238.5G  0 disk
â”œâ”€sda1        8:1    0   512M  0 part /boot/efi
â”œâ”€sda2        8:2    0   230G  0 part /
â””â”€sda3        8:3    0     8G  0 part [SWAP]
sdb           8:16   0 931.5G  0 disk
â””â”€sdb1        8:17   0 931.5G  0 part /mnt/data
```

å„åˆ—å«ä¹‰ï¼š

| åˆ—å | å«ä¹‰ |
|------|------|
| `NAME` | è®¾å¤‡åç§°ï¼Œç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼ˆç£ç›˜ â†’ åˆ†åŒºï¼‰ |
| `MAJ:MIN` | ä¸»è®¾å¤‡å·å’Œæ¬¡è®¾å¤‡å· |
| `RM` | æ˜¯å¦ä¸ºå¯ç§»åŠ¨è®¾å¤‡ï¼ˆ1 = æ˜¯ï¼‰ |
| `SIZE` | è®¾å¤‡å®¹é‡ |
| `RO` | æ˜¯å¦åªè¯»ï¼ˆ1 = åªè¯»ï¼‰ |
| `TYPE` | ç±»å‹ï¼šdiskï¼ˆç£ç›˜ï¼‰ã€partï¼ˆåˆ†åŒºï¼‰ã€lvmï¼ˆé€»è¾‘å·ï¼‰ |
| `MOUNTPOINTS` | æŒ‚è½½ç‚¹è·¯å¾„ |

### df è¾“å‡ºè§£è¯»

è¿è¡Œ `df -h` åä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š

```
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda2       230G   45G  174G  21% /
/dev/sda1       512M   12M  500M   3% /boot/efi
/dev/sdb1       932G  200G  685G  23% /mnt/data
tmpfs           3.9G   28M  3.9G   1% /dev/shm
```

- **Size**ï¼šåˆ†åŒºæ€»å¤§å°
- **Used / Avail**ï¼šå·²ç”¨ / å¯ç”¨ç©ºé—´
- **Use%**ï¼šä½¿ç”¨ç‡ç™¾åˆ†æ¯”ï¼Œè¶…è¿‡ 90% æ—¶éœ€è¦æ³¨æ„æ¸…ç†
- **Mounted on**ï¼šæŒ‚è½½ç‚¹

:::tip
å½“ `Use%` æ¥è¿‘ 100% æ—¶ï¼Œç³»ç»Ÿå¯èƒ½ä¼šå‡ºç°å¼‚å¸¸ã€‚å»ºè®®æ—¥å¸¸ä¿æŒæ ¹åˆ†åŒºä½¿ç”¨ç‡åœ¨ 80% ä»¥ä¸‹ã€‚
:::

## ğŸ“Š æ–‡ä»¶ç³»ç»Ÿç±»å‹

### å¸¸è§æ–‡ä»¶ç³»ç»Ÿå¯¹æ¯”

| æ–‡ä»¶ç³»ç»Ÿ | æœ€å¤§æ–‡ä»¶ | æœ€å¤§åˆ†åŒº | ä¸»è¦ç‰¹ç‚¹ | æ¨èåœºæ™¯ | Debian æ¨èåº¦ |
|----------|----------|----------|----------|----------|---------------|
| **ext4** | 16 TB | 1 EB | ç¨³å®šå¯é ï¼Œæ—¥å¿—åŠŸèƒ½ï¼Œå‘åå…¼å®¹ | é€šç”¨ç³»ç»Ÿåˆ†åŒº | é»˜è®¤æ¨è |
| **Btrfs** | 16 EB | 16 EB | å¿«ç…§ã€å‹ç¼©ã€å­å·ã€æ ¡éªŒå’Œ | éœ€è¦å¿«ç…§æˆ–æ•°æ®æ ¡éªŒ | æ¨è |
| **XFS** | 8 EB | 8 EB | é«˜æ€§èƒ½ã€å¹¶è¡Œ I/Oã€åœ¨çº¿æ‰©å±• | å¤§æ–‡ä»¶ã€æ•°æ®åº“ | æ¨è |
| **NTFS** | 16 TB | 256 TB | Windows é»˜è®¤æ–‡ä»¶ç³»ç»Ÿ | åŒç³»ç»Ÿå…±äº«æ•°æ® | å…¼å®¹ä½¿ç”¨ |
| **FAT32** | 4 GB | 2 TB | å…¼å®¹æ€§æœ€å¹¿ | U ç›˜ã€EFI åˆ†åŒº | ä»…é™ç‰¹æ®Šç”¨é€” |
| **exFAT** | 16 EB | 128 PB | æ—  4 GB é™åˆ¶çš„ FAT | U ç›˜ã€å¤–æ¥å­˜å‚¨ | å…¼å®¹ä½¿ç”¨ |
| **swap** | â€” | â€” | äº¤æ¢ç©ºé—´ | å†…å­˜ä¸è¶³æ—¶çš„è¡¥å…… | å¿…éœ€ |

### é€‰æ‹©å»ºè®®

- **é€šç”¨æ¡Œé¢ / æœåŠ¡å™¨**ï¼šé€‰æ‹© **ext4**ï¼Œå®ƒæ˜¯ Debian é»˜è®¤æ–‡ä»¶ç³»ç»Ÿï¼Œç¨³å®šæ€§ç»è¿‡é•¿æœŸéªŒè¯
- **éœ€è¦å¿«ç…§åŠŸèƒ½**ï¼šé€‰æ‹© **Btrfs**ï¼Œæ”¯æŒé€æ˜å‹ç¼©å’Œå¿«ç…§å›æ»š
- **å¤§æ–‡ä»¶å’Œæ•°æ®åº“**ï¼šé€‰æ‹© **XFS**ï¼Œåœ¨å¤„ç†å¤§æ–‡ä»¶å’Œé«˜å¹¶å‘ I/O æ—¶è¡¨ç°ä¼˜ç§€
- **ä¸ Windows å…±äº«æ•°æ®**ï¼šé€‰æ‹© **NTFS**ï¼ˆåªè¯»æ€§èƒ½å¥½ï¼‰æˆ– **exFAT**ï¼ˆè¯»å†™å…¼å®¹ï¼‰
- **U ç›˜å’Œå¯åŠ¨åˆ†åŒº**ï¼šé€‰æ‹© **FAT32**ï¼ˆEFI åˆ†åŒºå¿…é¡»ä½¿ç”¨ FAT32ï¼‰

:::tip
å¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œä¸ç¡®å®šé€‰å“ªä¸ªï¼Œå°±é€‰ ext4ã€‚å®ƒæ˜¯æœ€å®‰å…¨ã€æœ€æˆç†Ÿçš„é€‰æ‹©ã€‚
:::

## ğŸ”§ åˆ†åŒºå·¥å…·

### fdiskï¼ˆå‘½ä»¤è¡Œåˆ†åŒºå·¥å…·ï¼‰

`fdisk` æ˜¯ Linux æœ€ç»å…¸çš„å‘½ä»¤è¡Œåˆ†åŒºå·¥å…·ï¼Œé€‚åˆ MBR å’Œ GPT åˆ†åŒºè¡¨ï¼š

```bash
# å¯¹ /dev/sdb è¿›è¡Œåˆ†åŒºæ“ä½œ
sudo fdisk /dev/sdb

# è¿›å…¥äº¤äº’æ¨¡å¼åå¸¸ç”¨å‘½ä»¤ï¼š
# m - æ˜¾ç¤ºå¸®åŠ©èœå•
# p - æ‰“å°å½“å‰åˆ†åŒºè¡¨
# n - åˆ›å»ºæ–°åˆ†åŒº
# d - åˆ é™¤åˆ†åŒº
# t - æ›´æ”¹åˆ†åŒºç±»å‹
# w - å†™å…¥åˆ†åŒºè¡¨å¹¶é€€å‡º
# q - ä¸ä¿å­˜é€€å‡º
```

åˆ›å»ºæ–°åˆ†åŒºçš„å®Œæ•´äº¤äº’æµç¨‹ç¤ºä¾‹ï¼š

```bash
sudo fdisk /dev/sdb
# è¾“å…¥ nï¼ˆåˆ›å»ºæ–°åˆ†åŒºï¼‰
# è¾“å…¥ pï¼ˆé€‰æ‹©ä¸»åˆ†åŒºï¼‰
# è¾“å…¥ 1ï¼ˆåˆ†åŒºç¼–å·ï¼‰
# æŒ‰ Enterï¼ˆä½¿ç”¨é»˜è®¤èµ·å§‹æ‰‡åŒºï¼‰
# æŒ‰ Enterï¼ˆä½¿ç”¨å…¨éƒ¨å‰©ä½™ç©ºé—´ï¼‰æˆ–è¾“å…¥ +50Gï¼ˆæŒ‡å®šå¤§å°ï¼‰
# è¾“å…¥ wï¼ˆå†™å…¥ä¿å­˜ï¼‰
```

### partedï¼ˆæ”¯æŒ GPT çš„åˆ†åŒºå·¥å…·ï¼‰

`parted` åŠŸèƒ½æ›´å¼ºå¤§ï¼ŒåŸç”Ÿæ”¯æŒ GPT åˆ†åŒºè¡¨å’Œå¤§å®¹é‡ç£ç›˜ï¼š

```bash
# å¯¹ /dev/sdb è¿›è¡Œåˆ†åŒºæ“ä½œ
sudo parted /dev/sdb

# äº¤äº’æ¨¡å¼ä¸­å¸¸ç”¨å‘½ä»¤ï¼š
# print      - æ˜¾ç¤ºå½“å‰åˆ†åŒºä¿¡æ¯
# mklabel gpt - åˆ›å»º GPT åˆ†åŒºè¡¨
# mkpart primary ext4 0% 100% - åˆ›å»ºä¸€ä¸ªå æ»¡æ•´å—ç£ç›˜çš„åˆ†åŒº
# rm 1       - åˆ é™¤ç¬¬ 1 ä¸ªåˆ†åŒº
# quit       - é€€å‡º
```

ä¸€è¡Œå‘½ä»¤å®Œæˆåˆ†åŒºï¼ˆéäº¤äº’å¼ï¼‰ï¼š

```bash
# åˆ›å»º GPT åˆ†åŒºè¡¨
sudo parted /dev/sdb mklabel gpt

# åˆ›å»ºä¸€ä¸ªå æ»¡æ•´å—ç£ç›˜çš„åˆ†åŒº
sudo parted /dev/sdb mkpart primary ext4 0% 100%
```

### GPartedï¼ˆå›¾å½¢ç•Œé¢åˆ†åŒºå·¥å…·ï¼‰

GParted æ˜¯ä¸€æ¬¾ç›´è§‚çš„å›¾å½¢åŒ–åˆ†åŒºç®¡ç†å·¥å…·ï¼Œéå¸¸é€‚åˆåˆå­¦è€…ï¼š

```bash
# å®‰è£… GParted
sudo apt install gparted

# å¯åŠ¨ GParted
sudo gparted
```

:::tip
æ–°æ‰‹æ¨èä½¿ç”¨ GParted å›¾å½¢ç•Œé¢å·¥å…·ï¼Œæ“ä½œæ›´ç›´è§‚ï¼Œä¸”å¯ä»¥é¢„è§ˆæ›´æ”¹åå†åº”ç”¨ï¼Œé¿å…è¯¯æ“ä½œã€‚
:::

:::danger
åˆ†åŒºæ“ä½œä¼šä¿®æ”¹ç£ç›˜ç»“æ„ã€‚åœ¨æ“ä½œä¹‹å‰ï¼Œè¯·åŠ¡å¿…å¤‡ä»½é‡è¦æ•°æ®ã€‚å¯¹å·²æœ‰æ•°æ®çš„ç£ç›˜è¿›è¡Œåˆ†åŒºæ“ä½œå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚
:::

## â• æ·»åŠ æ–°ç¡¬ç›˜

### å®Œæ•´æµç¨‹

å½“ä½ å‘ç³»ç»Ÿä¸­æ·»åŠ ä¸€å—æ–°ç¡¬ç›˜æ—¶ï¼Œéœ€è¦æŒ‰ä»¥ä¸‹æµç¨‹æ“ä½œï¼š

```mermaid
flowchart TD
    A["1. è¯†åˆ«æ–°ç¡¬ç›˜\nlsblk"] --> B["2. åˆ›å»ºåˆ†åŒºè¡¨\nfdisk / parted"]
    B --> C["3. åˆ›å»ºåˆ†åŒº\nfdisk / parted"]
    C --> D["4. æ ¼å¼åŒ–åˆ†åŒº\nmkfs.ext4"]
    D --> E["5. åˆ›å»ºæŒ‚è½½ç‚¹\nmkdir"]
    E --> F["6. æŒ‚è½½åˆ†åŒº\nmount"]
    F --> G["7. é…ç½®è‡ªåŠ¨æŒ‚è½½\nç¼–è¾‘ /etc/fstab"]
    G --> H["8. éªŒè¯\ndf -h"]

    style A fill:#e3f2fd,stroke:#1565c0,color:#000
    style B fill:#e3f2fd,stroke:#1565c0,color:#000
    style C fill:#e3f2fd,stroke:#1565c0,color:#000
    style D fill:#e8f5e9,stroke:#2e7d32,color:#000
    style E fill:#e8f5e9,stroke:#2e7d32,color:#000
    style F fill:#fff3e0,stroke:#ef6c00,color:#000
    style G fill:#fff3e0,stroke:#ef6c00,color:#000
    style H fill:#f3e5f5,stroke:#7b1fa2,color:#000
```

### æ­¥éª¤è¯¦è§£

#### ç¬¬ 1 æ­¥ï¼šè¯†åˆ«æ–°ç¡¬ç›˜

```bash
# æŸ¥çœ‹æ‰€æœ‰å—è®¾å¤‡ï¼Œæ‰¾åˆ°æ–°æ·»åŠ çš„ç£ç›˜
lsblk

# è¾“å‡ºç¤ºä¾‹ï¼ˆsdb ä¸ºæ–°æ·»åŠ çš„ç£ç›˜ï¼Œæ²¡æœ‰åˆ†åŒºå’ŒæŒ‚è½½ç‚¹ï¼‰ï¼š
# NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS
# sda      8:0    0 238.5G  0 disk
# â”œâ”€sda1   8:1    0   512M  0 part /boot/efi
# â”œâ”€sda2   8:2    0   230G  0 part /
# â””â”€sda3   8:3    0     8G  0 part [SWAP]
# sdb      8:16   0 500.0G  0 disk            â† æ–°ç¡¬ç›˜
```

#### ç¬¬ 2 æ­¥ï¼šåˆ›å»ºåˆ†åŒº

```bash
# ä½¿ç”¨ parted åˆ›å»º GPT åˆ†åŒºè¡¨å¹¶åˆ†åŒºï¼ˆæ¨èï¼‰
sudo parted /dev/sdb mklabel gpt
sudo parted /dev/sdb mkpart primary ext4 0% 100%

# æˆ–è€…ä½¿ç”¨ fdisk
sudo fdisk /dev/sdb
# ç„¶åæŒ‰äº¤äº’æ­¥éª¤æ“ä½œï¼ˆå‚è§å‰æ–‡ fdisk éƒ¨åˆ†ï¼‰
```

#### ç¬¬ 3 æ­¥ï¼šæ ¼å¼åŒ–åˆ†åŒº

```bash
# å°†æ–°åˆ†åŒºæ ¼å¼åŒ–ä¸º ext4 æ–‡ä»¶ç³»ç»Ÿ
sudo mkfs.ext4 /dev/sdb1

# å¦‚æœéœ€è¦å…¶ä»–æ–‡ä»¶ç³»ç»Ÿï¼š
# sudo mkfs.btrfs /dev/sdb1    # Btrfs
# sudo mkfs.xfs /dev/sdb1      # XFS
# sudo mkfs.vfat /dev/sdb1     # FAT32
```

#### ç¬¬ 4 æ­¥ï¼šåˆ›å»ºæŒ‚è½½ç‚¹

```bash
# åˆ›å»ºç”¨äºæŒ‚è½½çš„ç›®å½•
sudo mkdir -p /mnt/data
```

#### ç¬¬ 5 æ­¥ï¼šæŒ‚è½½åˆ†åŒº

```bash
# å°†åˆ†åŒºæŒ‚è½½åˆ°æŒ‚è½½ç‚¹
sudo mount /dev/sdb1 /mnt/data

# éªŒè¯æŒ‚è½½æ˜¯å¦æˆåŠŸ
df -h /mnt/data
```

#### ç¬¬ 6 æ­¥ï¼šé…ç½®è‡ªåŠ¨æŒ‚è½½ï¼ˆfstabï¼‰

```bash
# è·å–åˆ†åŒºçš„ UUID
sudo blkid /dev/sdb1
# è¾“å‡ºç¤ºä¾‹ï¼š/dev/sdb1: UUID="a1b2c3d4-e5f6-7890-abcd-ef1234567890" TYPE="ext4"

# ç¼–è¾‘ fstab æ–‡ä»¶
sudo nano /etc/fstab

# åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸€è¡Œï¼ˆå°† UUID æ›¿æ¢ä¸ºä½ å®é™…çš„å€¼ï¼‰ï¼š
# UUID=a1b2c3d4-e5f6-7890-abcd-ef1234567890  /mnt/data  ext4  defaults  0  2
```

#### ç¬¬ 7 æ­¥ï¼šéªŒè¯é…ç½®

```bash
# å…ˆå¸è½½åˆ†åŒº
sudo umount /mnt/data

# æµ‹è¯• fstab é…ç½®æ˜¯å¦æ­£ç¡®ï¼ˆæŒ‚è½½ fstab ä¸­æ‰€æœ‰æœªæŒ‚è½½çš„æ¡ç›®ï¼‰
sudo mount -a

# ç¡®è®¤æŒ‚è½½æˆåŠŸ
df -h /mnt/data

# ç¡®è®¤æ— é”™è¯¯ä¿¡æ¯
lsblk
```

:::warning
ç¼–è¾‘ `/etc/fstab` æ—¶åŠ¡å¿…å°å¿ƒã€‚å¦‚æœé…ç½®é”™è¯¯ï¼Œç³»ç»Ÿé‡å¯åå¯èƒ½æ— æ³•æ­£å¸¸å¯åŠ¨ã€‚å»ºè®®æ¯æ¬¡ä¿®æ”¹åéƒ½ç”¨ `sudo mount -a` æµ‹è¯•ã€‚
:::

## ğŸ“ æŒ‚è½½ç®¡ç†

### mount å’Œ umount å‘½ä»¤

```bash
# æŒ‚è½½ä¸€ä¸ªåˆ†åŒºåˆ°æŒ‡å®šç›®å½•
sudo mount /dev/sdb1 /mnt/data

# ä»¥åªè¯»æ–¹å¼æŒ‚è½½
sudo mount -o ro /dev/sdb1 /mnt/data

# æŒ‚è½½å¹¶æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹
sudo mount -t ext4 /dev/sdb1 /mnt/data

# å¸¦å¤šä¸ªé€‰é¡¹æŒ‚è½½
sudo mount -o rw,noexec,nosuid /dev/sdb1 /mnt/data

# å¸è½½åˆ†åŒº
sudo umount /mnt/data

# å¦‚æœè®¾å¤‡æ­£å¿™ï¼Œå¼ºåˆ¶å¸è½½ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
sudo umount -l /mnt/data

# æŸ¥çœ‹å½“å‰æ‰€æœ‰æŒ‚è½½ç‚¹
mount | column -t
```

### /etc/fstab è¯¦è§£

`/etc/fstab` æ˜¯æ§åˆ¶ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½è¡Œä¸ºçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼š

```bash
# /etc/fstab æ ¼å¼ï¼š
# <è®¾å¤‡>         <æŒ‚è½½ç‚¹>   <ç±»å‹>  <é€‰é¡¹>     <dump>  <pass>
UUID=a1b2c3d4    /          ext4    defaults   0       1
UUID=e5f6a7b8    /boot/efi  vfat    umask=0077 0       1
UUID=c9d0e1f2    /mnt/data  ext4    defaults   0       2
/swapfile        swap       swap    defaults   0       0
```

å„å­—æ®µè¯´æ˜ï¼š

| å­—æ®µ | è¯´æ˜ | å¸¸ç”¨å€¼ |
|------|------|--------|
| è®¾å¤‡ | åˆ†åŒºæ ‡è¯†ï¼Œæ¨èä½¿ç”¨ UUID | `UUID=xxxx`ã€`/dev/sdb1` |
| æŒ‚è½½ç‚¹ | æŒ‚è½½åˆ°ç›®å½•æ ‘ä¸­çš„è·¯å¾„ | `/mnt/data`ã€`/home` |
| ç±»å‹ | æ–‡ä»¶ç³»ç»Ÿç±»å‹ | `ext4`ã€`btrfs`ã€`xfs`ã€`swap` |
| é€‰é¡¹ | æŒ‚è½½é€‰é¡¹ | `defaults`ã€`ro`ã€`noexec` |
| dump | æ˜¯å¦å…è®¸ dump å¤‡ä»½ | `0`ï¼ˆç¦ç”¨ï¼‰æˆ– `1`ï¼ˆå¯ç”¨ï¼‰ |
| pass | å¯åŠ¨æ—¶ fsck æ£€æŸ¥é¡ºåº | `0`ï¼ˆä¸æ£€æŸ¥ï¼‰ã€`1`ï¼ˆæ ¹åˆ†åŒºï¼‰ã€`2`ï¼ˆå…¶ä»–åˆ†åŒºï¼‰ |

### å¸¸ç”¨æŒ‚è½½é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `defaults` | ç­‰åŒäº rw,suid,dev,exec,auto,nouser,async |
| `rw` | è¯»å†™æ¨¡å¼ |
| `ro` | åªè¯»æ¨¡å¼ |
| `noexec` | ç¦æ­¢æ‰§è¡Œè¯¥åˆ†åŒºä¸Šçš„å¯æ‰§è¡Œæ–‡ä»¶ |
| `nosuid` | å¿½ç•¥ SUID/SGID ä½ |
| `nodev` | ç¦æ­¢åœ¨è¯¥åˆ†åŒºä¸Šè§£é‡Šå­—ç¬¦æˆ–å—è®¾å¤‡ |
| `auto` | ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½ |
| `noauto` | ä¸è‡ªåŠ¨æŒ‚è½½ï¼Œéœ€è¦æ‰‹åŠ¨ mount |
| `nofail` | å³ä½¿è®¾å¤‡ä¸å­˜åœ¨ä¹Ÿä¸æŠ¥é”™ï¼ˆé€‚åˆå¤–æ¥ç¡¬ç›˜ï¼‰ |
| `user` | å…è®¸æ™®é€šç”¨æˆ·æŒ‚è½½ |

### ä½¿ç”¨ UUID è€Œéè®¾å¤‡å

```bash
# è·å–åˆ†åŒºçš„ UUID
sudo blkid /dev/sdb1

# è¾“å‡ºç¤ºä¾‹ï¼š
# /dev/sdb1: UUID="a1b2c3d4-e5f6-7890-abcd-ef1234567890" TYPE="ext4"

# åœ¨ fstab ä¸­ä½¿ç”¨ UUIDï¼ˆæ¨èå†™æ³•ï¼‰
UUID=a1b2c3d4-e5f6-7890-abcd-ef1234567890  /mnt/data  ext4  defaults  0  2
```

:::tip
å§‹ç»ˆä½¿ç”¨ UUID è€Œä¸æ˜¯ `/dev/sdX` è®¾å¤‡åæ¥æ ‡è¯†åˆ†åŒºã€‚è®¾å¤‡åï¼ˆå¦‚ `/dev/sdb1`ï¼‰å¯èƒ½åœ¨æ·»åŠ æˆ–ç§»é™¤ç¡¬ç›˜åå‘ç”Ÿå˜åŒ–ï¼Œè€Œ UUID æ˜¯åˆ†åŒºçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸ä¼šæ”¹å˜ã€‚
:::

## ğŸ’¾ LVM é€»è¾‘å·ç®¡ç†

### LVM æ¦‚å¿µ

LVMï¼ˆLogical Volume Managerï¼‰æ˜¯ Linux ä¸­å¼ºå¤§çš„ç£ç›˜ç®¡ç†æ–¹æ¡ˆï¼Œåœ¨ç‰©ç†ç£ç›˜å’Œæ–‡ä»¶ç³»ç»Ÿä¹‹é—´å¢åŠ äº†ä¸€å±‚é€»è¾‘æŠ½è±¡ï¼Œå®ç°çµæ´»çš„ç©ºé—´ç®¡ç†ï¼š

```mermaid
flowchart TD
    subgraph PV ["ç‰©ç†å· Physical Volumes"]
        PV1["/dev/sdb1\n100 GB"]
        PV2["/dev/sdc1\n200 GB"]
        PV3["/dev/sdd1\n150 GB"]
    end

    subgraph VG ["å·ç»„ Volume Group: vg-data (å…± 450 GB)"]
        direction LR
        LV1["é€»è¾‘å· lv-home\n200 GB"]
        LV2["é€»è¾‘å· lv-var\n100 GB"]
        LV3["ç©ºé—²ç©ºé—´\n150 GB"]
    end

    PV1 --> VG
    PV2 --> VG
    PV3 --> VG

    LV1 --> M1["æŒ‚è½½åˆ° /home"]
    LV2 --> M2["æŒ‚è½½åˆ° /var"]

    style PV fill:#e3f2fd,stroke:#1565c0,color:#000
    style VG fill:#e8f5e9,stroke:#2e7d32,color:#000
    style LV1 fill:#fff3e0,stroke:#ef6c00,color:#000
    style LV2 fill:#fff3e0,stroke:#ef6c00,color:#000
    style LV3 fill:#fafafa,stroke:#9e9e9e,color:#000
    style M1 fill:#f3e5f5,stroke:#7b1fa2,color:#000
    style M2 fill:#f3e5f5,stroke:#7b1fa2,color:#000
```

LVM ä¸‰å±‚æ¶æ„ï¼š

| å±‚çº§ | ç¼©å†™ | è¯´æ˜ |
|------|------|------|
| ç‰©ç†å· | PV (Physical Volume) | å®é™…çš„ç£ç›˜åˆ†åŒºæˆ–æ•´å—ç£ç›˜ |
| å·ç»„ | VG (Volume Group) | å°†å¤šä¸ª PV æ±‡èšæˆä¸€ä¸ªå­˜å‚¨æ±  |
| é€»è¾‘å· | LV (Logical Volume) | ä» VG ä¸­åˆ’åˆ†å‡ºæ¥çš„å¯ä½¿ç”¨ç©ºé—´ï¼Œç±»ä¼¼äºä¼ ç»Ÿåˆ†åŒº |

### ä¸ºä»€ä¹ˆä½¿ç”¨ LVM

- **çµæ´»æ‰©ç¼©å®¹**ï¼šé€»è¾‘å·å¯ä»¥åœ¨çº¿æ‰©å±•ï¼Œæ— éœ€å¸è½½æ–‡ä»¶ç³»ç»Ÿ
- **è·¨ç£ç›˜åˆå¹¶**ï¼šå¤šå—ç‰©ç†ç£ç›˜å¯ä»¥ç»„åˆæˆä¸€ä¸ªå¤§çš„å­˜å‚¨æ± 
- **å¿«ç…§åŠŸèƒ½**ï¼šæ”¯æŒåˆ›å»ºå·å¿«ç…§ï¼Œæ–¹ä¾¿å¤‡ä»½å’Œæµ‹è¯•
- **æ˜“äºç®¡ç†**ï¼šæ·»åŠ æ–°ç£ç›˜ååªéœ€æ‰©å±•å·ç»„å³å¯å¢åŠ å¯ç”¨ç©ºé—´

### å®‰è£… LVM å·¥å…·

```bash
# å®‰è£… LVM2 å·¥å…·åŒ…
sudo apt install lvm2
```

### åˆ›å»º LVM å®Œæ•´æµç¨‹

```bash
# ç¬¬ 1 æ­¥ï¼šåˆ›å»ºç‰©ç†å·ï¼ˆPVï¼‰
sudo pvcreate /dev/sdb1 /dev/sdc1

# æŸ¥çœ‹ç‰©ç†å·ä¿¡æ¯
sudo pvs
sudo pvdisplay

# ç¬¬ 2 æ­¥ï¼šåˆ›å»ºå·ç»„ï¼ˆVGï¼‰ï¼Œåç§°ä¸º vg-data
sudo vgcreate vg-data /dev/sdb1 /dev/sdc1

# æŸ¥çœ‹å·ç»„ä¿¡æ¯
sudo vgs
sudo vgdisplay

# ç¬¬ 3 æ­¥ï¼šåˆ›å»ºé€»è¾‘å·ï¼ˆLVï¼‰ï¼Œåç§°ä¸º lv-homeï¼Œå¤§å° 50 GB
sudo lvcreate -L 50G -n lv-home vg-data

# æŸ¥çœ‹é€»è¾‘å·ä¿¡æ¯
sudo lvs
sudo lvdisplay

# ç¬¬ 4 æ­¥ï¼šæ ¼å¼åŒ–é€»è¾‘å·
sudo mkfs.ext4 /dev/vg-data/lv-home

# ç¬¬ 5 æ­¥ï¼šæŒ‚è½½é€»è¾‘å·
sudo mkdir -p /mnt/home
sudo mount /dev/vg-data/lv-home /mnt/home

# ç¬¬ 6 æ­¥ï¼šæ·»åŠ åˆ° fstab å®ç°è‡ªåŠ¨æŒ‚è½½
# å…ˆè·å– UUID
sudo blkid /dev/vg-data/lv-home
# ç„¶åç¼–è¾‘ /etc/fstab æ·»åŠ ï¼š
# UUID=xxxx  /mnt/home  ext4  defaults  0  2
```

### æ‰©å±•é€»è¾‘å·

```bash
# æ‰©å±•é€»è¾‘å·ï¼Œå¢åŠ  10 GB
sudo lvextend -L +10G /dev/vg-data/lv-home

# æ‰©å±•æ–‡ä»¶ç³»ç»Ÿä»¥ä½¿ç”¨æ–°å¢ç©ºé—´
sudo resize2fs /dev/vg-data/lv-home

# æˆ–è€…ä¸€æ­¥å®Œæˆæ‰©å±•ï¼ˆæ¨èï¼‰ï¼Œä½¿ç”¨æ‰€æœ‰å·ç»„ä¸­çš„å‰©ä½™ç©ºé—´
sudo lvextend -l +100%FREE /dev/vg-data/lv-home
sudo resize2fs /dev/vg-data/lv-home

# å¯¹äº XFS æ–‡ä»¶ç³»ç»Ÿï¼Œä½¿ç”¨ xfs_growfs ä»£æ›¿ resize2fs
# sudo xfs_growfs /mnt/home
```

### å‘å·ç»„æ·»åŠ æ–°ç£ç›˜

```bash
# å°†æ–°ç£ç›˜åˆ›å»ºä¸ºç‰©ç†å·
sudo pvcreate /dev/sdd1

# å°†æ–°ç‰©ç†å·åŠ å…¥ç°æœ‰å·ç»„
sudo vgextend vg-data /dev/sdd1

# æŸ¥çœ‹å·ç»„å¯ç”¨ç©ºé—´
sudo vgs
```

:::warning
ç¼©å°é€»è¾‘å·æ˜¯ä¸€é¡¹é«˜é£é™©æ“ä½œã€‚ext4 æ–‡ä»¶ç³»ç»Ÿæ”¯æŒç¼©å°ä½†å¿…é¡»å…ˆå¸è½½ï¼ŒXFS æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒç¼©å°ã€‚å»ºè®®ä»…åœ¨å¿…è¦æ—¶æ‰§è¡Œï¼Œä¸”æ“ä½œå‰åŠ¡å¿…å¤‡ä»½æ•°æ®ã€‚
:::

## ğŸ”„ äº¤æ¢ç©ºé—´ï¼ˆSwapï¼‰

### Swap åˆ†åŒº vs Swap æ–‡ä»¶

| ç‰¹æ€§ | Swap åˆ†åŒº | Swap æ–‡ä»¶ |
|------|-----------|-----------|
| åˆ›å»ºæ–¹å¼ | éœ€è¦ä¸“ç”¨åˆ†åŒº | åœ¨ç°æœ‰æ–‡ä»¶ç³»ç»Ÿä¸Šåˆ›å»ºæ–‡ä»¶ |
| çµæ´»æ€§ | éœ€è¦é‡æ–°åˆ†åŒºæ‰èƒ½è°ƒæ•´å¤§å° | å¯ä»¥éšæ—¶åˆ›å»ºã€åˆ é™¤æˆ–è°ƒæ•´å¤§å° |
| æ€§èƒ½ | ç•¥ä¼˜ï¼ˆç›´æ¥è®¿é—®ç£ç›˜ï¼‰ | å‡ ä¹æ— å·®åˆ«ï¼ˆç°ä»£å†…æ ¸å·²ä¼˜åŒ–ï¼‰ |
| é€‚ç”¨åœºæ™¯ | å®‰è£…æ—¶è§„åˆ’å¥½çš„å›ºå®šé…ç½® | åæœŸéœ€è¦æ·»åŠ æˆ–è°ƒæ•´ swap æ—¶ |
| æ¨èåº¦ | ä¼ ç»Ÿæ–¹æ¡ˆ | Debian 13 æ¨èæ–¹æ¡ˆ |

### åˆ›å»º Swap æ–‡ä»¶

```bash
# åˆ›å»ºä¸€ä¸ª 4 GB çš„ swap æ–‡ä»¶
sudo fallocate -l 4G /swapfile

# å¦‚æœ fallocate ä¸å¯ç”¨ï¼ˆæŸäº›æ–‡ä»¶ç³»ç»Ÿä¸æ”¯æŒï¼‰ï¼Œä½¿ç”¨ ddï¼š
# sudo dd if=/dev/zero of=/swapfile bs=1M count=4096

# è®¾ç½®æ­£ç¡®çš„æƒé™ï¼ˆä»… root å¯è¯»å†™ï¼‰
sudo chmod 600 /swapfile

# å°†æ–‡ä»¶åˆå§‹åŒ–ä¸º swap æ ¼å¼
sudo mkswap /swapfile

# å¯ç”¨ swap æ–‡ä»¶
sudo swapon /swapfile

# éªŒè¯ swap æ˜¯å¦å·²å¯ç”¨
swapon --show

# æ·»åŠ åˆ° fstab å®ç°å¼€æœºè‡ªåŠ¨å¯ç”¨
echo '/swapfile swap swap defaults 0 0' | sudo tee -a /etc/fstab
```

### Swap å¤§å°å»ºè®®

| ç‰©ç†å†…å­˜ | æ¨è Swap å¤§å° | éœ€è¦ä¼‘çœ æ—¶ |
|----------|----------------|------------|
| 2 GB ä»¥ä¸‹ | å†…å­˜çš„ 2 å€ | å†…å­˜çš„ 3 å€ |
| 2 - 8 GB | ä¸å†…å­˜ç›¸åŒ | å†…å­˜çš„ 2 å€ |
| 8 - 64 GB | 4 - 8 GB | å†…å­˜çš„ 1.5 å€ |
| 64 GB ä»¥ä¸Š | 4 GBï¼ˆæˆ–ä¸ç”¨ï¼‰ | ä¸å»ºè®®ä¼‘çœ  |

### è°ƒæ•´ Swappiness

Swappiness å‚æ•°æ§åˆ¶å†…æ ¸å°†æ•°æ®ä»å†…å­˜ç§»åˆ° swap çš„å€¾å‘ï¼Œå–å€¼èŒƒå›´ 0-100ï¼š

- **0**ï¼šå°½å¯èƒ½ä¸ä½¿ç”¨ swapï¼ˆä»…åœ¨å†…å­˜æåº¦ä¸è¶³æ—¶ä½¿ç”¨ï¼‰
- **10**ï¼šæ¨èæ¡Œé¢ç³»ç»Ÿä½¿ç”¨çš„å€¼
- **60**ï¼šDebian é»˜è®¤å€¼
- **100**ï¼šç§¯æä½¿ç”¨ swap

```bash
# æŸ¥çœ‹å½“å‰ swappiness å€¼
cat /proc/sys/vm/swappiness

# ä¸´æ—¶ä¿®æ”¹ï¼ˆé‡å¯åå¤±æ•ˆï¼‰
sudo sysctl vm.swappiness=10

# æ°¸ä¹…ä¿®æ”¹
echo 'vm.swappiness=10' | sudo tee -a /etc/sysctl.conf

# ç«‹å³ç”Ÿæ•ˆ
sudo sysctl -p
```

:::tip
æ¡Œé¢ç”¨æˆ·å»ºè®®å°† swappiness è®¾ä¸º 10ï¼Œè¿™æ ·ç³»ç»Ÿä¼šä¼˜å…ˆä½¿ç”¨ç‰©ç†å†…å­˜ï¼Œå‡å°‘ä¸å¿…è¦çš„ç£ç›˜è¯»å†™ï¼Œæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦ã€‚
:::

## ğŸ§¹ ç£ç›˜ç©ºé—´æ¸…ç†

### å¸¸ç”¨æ¸…ç†å‘½ä»¤

```bash
# æ¸…ç† APT è½¯ä»¶åŒ…ç¼“å­˜
sudo apt clean           # åˆ é™¤æ‰€æœ‰å·²ä¸‹è½½çš„ .deb åŒ…
sudo apt autoclean       # ä»…åˆ é™¤å·²è¿‡æ—¶çš„ .deb åŒ…
sudo apt autoremove      # åˆ é™¤ä¸å†éœ€è¦çš„ä¾èµ–åŒ…

# æ¸…ç†æ—§å†…æ ¸ï¼ˆé‡Šæ”¾ /boot ç©ºé—´ï¼‰
sudo apt autoremove --purge

# é™åˆ¶ systemd æ—¥å¿—å¤§å°
sudo journalctl --vacuum-size=100M    # å°†æ—¥å¿—é™åˆ¶ä¸º 100 MB
sudo journalctl --vacuum-time=7d      # ä»…ä¿ç•™æœ€è¿‘ 7 å¤©çš„æ—¥å¿—

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
sudo rm -rf /tmp/*
sudo rm -rf /var/tmp/*

# æŸ¥æ‰¾ç³»ç»Ÿä¸­æœ€å¤§çš„æ–‡ä»¶å’Œç›®å½•
sudo du -ah / --exclude=/proc --exclude=/sys | sort -rh | head -20

# æŸ¥æ‰¾è¶…è¿‡ 100 MB çš„å¤§æ–‡ä»¶
sudo find / -type f -size +100M -exec ls -lh {} \; 2>/dev/null

# æ¸…ç†ç”¨æˆ·ç¼“å­˜
rm -rf ~/.cache/thumbnails/*
```

### è‡ªåŠ¨æ¸…ç†è„šæœ¬

åˆ›å»ºä¸€ä¸ªç®€å•çš„ç£ç›˜æ¸…ç†è„šæœ¬ `/usr/local/bin/disk-cleanup.sh`ï¼š

```bash
#!/bin/bash
# ç£ç›˜æ¸…ç†è„šæœ¬ - Debian 13
# ç”¨æ³•ï¼šsudo bash /usr/local/bin/disk-cleanup.sh

echo "===== ç£ç›˜æ¸…ç†å¼€å§‹ ====="
echo ""

# æ˜¾ç¤ºæ¸…ç†å‰çš„ç£ç›˜ä½¿ç”¨æƒ…å†µ
echo "--- æ¸…ç†å‰ç£ç›˜ä½¿ç”¨ ---"
df -h /

# æ¸…ç† APT ç¼“å­˜
echo ""
echo "--- æ¸…ç† APT ç¼“å­˜ ---"
sudo apt clean
sudo apt autoclean
sudo apt autoremove -y

# æ¸…ç†æ—§æ—¥å¿—
echo ""
echo "--- æ¸…ç†æ—§æ—¥å¿— ---"
sudo journalctl --vacuum-size=100M

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
echo ""
echo "--- æ¸…ç†ä¸´æ—¶æ–‡ä»¶ ---"
sudo rm -rf /tmp/*
sudo rm -rf /var/tmp/*

# æ˜¾ç¤ºæ¸…ç†åçš„ç£ç›˜ä½¿ç”¨æƒ…å†µ
echo ""
echo "--- æ¸…ç†åç£ç›˜ä½¿ç”¨ ---"
df -h /

echo ""
echo "===== ç£ç›˜æ¸…ç†å®Œæˆ ====="
```

```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
sudo chmod +x /usr/local/bin/disk-cleanup.sh

# è¿è¡Œè„šæœ¬
sudo /usr/local/bin/disk-cleanup.sh
```

## ğŸ” ç£ç›˜åŠ å¯†ï¼ˆLUKSï¼‰

LUKSï¼ˆLinux Unified Key Setupï¼‰æ˜¯ Linux æ ‡å‡†çš„ç£ç›˜åŠ å¯†æ–¹æ¡ˆï¼Œç”¨äºä¿æŠ¤å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„æ•°æ®ã€‚

### å®‰è£…åŠ å¯†å·¥å…·

```bash
sudo apt install cryptsetup
```

### åŠ å¯†æ–°åˆ†åŒº

```bash
# ç¬¬ 1 æ­¥ï¼šæ ¼å¼åŒ–åˆ†åŒºä¸º LUKS åŠ å¯†æ ¼å¼ï¼ˆä¼šæ¸…é™¤åˆ†åŒºä¸Šçš„æ‰€æœ‰æ•°æ®ï¼‰
# ç³»ç»Ÿä¼šè¦æ±‚ä½ è¾“å…¥å¹¶ç¡®è®¤åŠ å¯†å¯†ç 
sudo cryptsetup luksFormat /dev/sdb1

# ç¬¬ 2 æ­¥ï¼šæ‰“å¼€ï¼ˆè§£é”ï¼‰åŠ å¯†åˆ†åŒºï¼Œæ˜ å°„ä¸º /dev/mapper/encrypted
sudo cryptsetup open /dev/sdb1 encrypted

# ç¬¬ 3 æ­¥ï¼šåœ¨è§£å¯†åçš„è®¾å¤‡ä¸Šåˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ
sudo mkfs.ext4 /dev/mapper/encrypted

# ç¬¬ 4 æ­¥ï¼šæŒ‚è½½åŠ å¯†åˆ†åŒº
sudo mkdir -p /mnt/secure
sudo mount /dev/mapper/encrypted /mnt/secure

# ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ /mnt/secure ç›®å½•è¯»å†™æ–‡ä»¶äº†
```

### å…³é—­åŠ å¯†åˆ†åŒº

```bash
# å…ˆå¸è½½æ–‡ä»¶ç³»ç»Ÿ
sudo umount /mnt/secure

# å…³é—­ï¼ˆé”å®šï¼‰åŠ å¯†åˆ†åŒº
sudo cryptsetup close encrypted
```

### å¼€æœºè‡ªåŠ¨æŒ‚è½½åŠ å¯†åˆ†åŒº

å¦‚æœéœ€è¦åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨æŒ‚è½½åŠ å¯†åˆ†åŒºï¼ˆå¯åŠ¨æ—¶ä¼šæç¤ºè¾“å…¥å¯†ç ï¼‰ï¼š

```bash
# è·å–åŠ å¯†åˆ†åŒºçš„ UUID
sudo blkid /dev/sdb1

# ç¼–è¾‘ /etc/crypttabï¼Œæ·»åŠ ï¼š
# encrypted  UUID=xxxx  none  luks

# ç¼–è¾‘ /etc/fstabï¼Œæ·»åŠ ï¼š
# /dev/mapper/encrypted  /mnt/secure  ext4  defaults  0  2
```

:::warning
åŠ å¯†å¯†ç ä¸€æ—¦å¿˜è®°ï¼Œæ•°æ®å°†æ— æ³•æ¢å¤ã€‚è¯·åŠ¡å¿…å¦¥å–„ä¿ç®¡å¯†ç ï¼Œå»ºè®®åœ¨å®‰å…¨çš„åœ°æ–¹è®°å½•å¤‡ä»½å¯†ç ã€‚
:::

:::danger
`cryptsetup luksFormat` å‘½ä»¤ä¼šå®Œå…¨æ“¦é™¤ç›®æ ‡åˆ†åŒºä¸Šçš„æ‰€æœ‰æ•°æ®ã€‚åœ¨æ‰§è¡Œä¹‹å‰è¯·ç¡®ä¿å·²å¤‡ä»½é‡è¦æ•°æ®ã€‚
:::

## ğŸ¥ SMART ç£ç›˜å¥åº·ç›‘æ§

### ä»€ä¹ˆæ˜¯ SMART

SMARTï¼ˆSelf-Monitoring, Analysis and Reporting Technologyï¼‰æ˜¯ç¡¬ç›˜å†…å»ºçš„å¥åº·ç›‘æ§æŠ€æœ¯ï¼Œå¯ä»¥é¢„è­¦æ½œåœ¨çš„ç¡¬ç›˜æ•…éšœã€‚

### å®‰è£…å’Œä½¿ç”¨

```bash
# å®‰è£… smartmontools
sudo apt install smartmontools

# æŸ¥çœ‹ç£ç›˜çš„å®Œæ•´ SMART ä¿¡æ¯
sudo smartctl -a /dev/sda

# å¿«é€Ÿå¥åº·æ£€æŸ¥ï¼ˆè¿”å› PASSED æˆ– FAILEDï¼‰
sudo smartctl -H /dev/sda

# æŸ¥çœ‹ç£ç›˜çš„é”™è¯¯æ—¥å¿—
sudo smartctl -l error /dev/sda

# è¿è¡ŒçŸ­æ—¶è‡ªæ£€ï¼ˆçº¦ 2 åˆ†é’Ÿï¼‰
sudo smartctl -t short /dev/sda

# è¿è¡Œé•¿æ—¶è‡ªæ£€ï¼ˆå¯èƒ½éœ€è¦æ•°å°æ—¶ï¼‰
sudo smartctl -t long /dev/sda

# æŸ¥çœ‹è‡ªæ£€ç»“æœ
sudo smartctl -l selftest /dev/sda
```

### å…³é”® SMART æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ | è­¦ç¤ºæ ‡å‡† |
|------|------|----------|
| `Reallocated_Sector_Ct` | é‡æ–°åˆ†é…çš„æ‰‡åŒºæ•° | å¤§äº 0 éœ€å…³æ³¨ |
| `Current_Pending_Sector` | å½“å‰å¾…é‡åˆ†é…çš„æ‰‡åŒº | å¤§äº 0 éœ€å…³æ³¨ |
| `Offline_Uncorrectable` | æ— æ³•ä¿®æ­£çš„ç¦»çº¿æ‰‡åŒº | å¤§äº 0 éœ€å…³æ³¨ |
| `UDMA_CRC_Error_Count` | æ•°æ®ä¼ è¾“é”™è¯¯è®¡æ•° | æŒç»­å¢é•¿éœ€æ£€æŸ¥çº¿ç¼† |
| `Temperature_Celsius` | ç¡¬ç›˜æ¸©åº¦ | è¶…è¿‡ 55Â°C éœ€æ”¹å–„æ•£çƒ­ |
| `Power_On_Hours` | é€šç”µè¿è¡Œæ—¶é—´ | ä»…ä¾›å‚è€ƒ |

### é…ç½®è‡ªåŠ¨ç›‘æ§

```bash
# å¯ç”¨ smartd å®ˆæŠ¤è¿›ç¨‹ï¼ˆè‡ªåŠ¨ç›‘æ§æ‰€æœ‰ç£ç›˜ï¼‰
sudo systemctl enable smartd
sudo systemctl start smartd

# ç¼–è¾‘ smartd é…ç½®æ–‡ä»¶ä»¥è‡ªå®šä¹‰ç›‘æ§è§„åˆ™
sudo nano /etc/smartd.conf

# ç¤ºä¾‹é…ç½®ï¼šç›‘æ§ /dev/sdaï¼Œå‘ç°é—®é¢˜æ—¶å‘é€é‚®ä»¶
# /dev/sda -a -o on -S on -s (S/../.././02|L/../../6/03) -m admin@example.com
```

:::tip
å»ºè®®è‡³å°‘æ¯æœˆæ£€æŸ¥ä¸€æ¬¡ SMART çŠ¶æ€ã€‚å½“ `Reallocated_Sector_Ct` æˆ– `Current_Pending_Sector` ä¸ä¸ºé›¶æ—¶ï¼Œåº”å°½å¿«å¤‡ä»½æ•°æ®å¹¶å‡†å¤‡æ›´æ¢ç¡¬ç›˜ã€‚
:::

## ğŸš¨ æ•…éšœæ’æŸ¥

### ç£ç›˜ç©ºé—´æ»¡äº†

```bash
# æŸ¥çœ‹æ•´ä½“ç£ç›˜ä½¿ç”¨æƒ…å†µ
df -h

# æ‰¾å‡ºå“ªäº›ç›®å½•å ç”¨äº†æœ€å¤šç©ºé—´
sudo du -sh /* | sort -rh | head -10

# è¿›ä¸€æ­¥æ·±å…¥åˆ°å ç”¨æœ€å¤šçš„ç›®å½•
sudo du -sh /var/* | sort -rh | head -10

# æŸ¥æ‰¾æœ€è¿‘ 7 å¤©å†…åˆ›å»ºçš„å¤§æ–‡ä»¶
sudo find / -type f -size +50M -mtime -7 -ls 2>/dev/null

# æ£€æŸ¥ inode ä½¿ç”¨æƒ…å†µï¼ˆå°æ–‡ä»¶è¿‡å¤šä¹Ÿä¼šå¯¼è‡´"ç©ºé—´æ»¡"ï¼‰
df -i
```

### æ— æ³•æŒ‚è½½åˆ†åŒº

```bash
# æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦æŸåï¼ˆåˆ†åŒºå¿…é¡»å…ˆå¸è½½ï¼‰
sudo fsck /dev/sdb1

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—è·å–é”™è¯¯ä¿¡æ¯
sudo dmesg | tail -30
sudo journalctl -xe

# æ£€æŸ¥ fstab é…ç½®æ˜¯å¦æ­£ç¡®
cat /etc/fstab

# å°è¯•æ‰‹åŠ¨æŒ‚è½½å¹¶æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
sudo mount -v /dev/sdb1 /mnt/data
```

### æ–‡ä»¶ç³»ç»Ÿé”™è¯¯ä¿®å¤

```bash
# é‡è¦ï¼šå¿…é¡»å…ˆå¸è½½æ–‡ä»¶ç³»ç»Ÿæ‰èƒ½ä¿®å¤
sudo umount /dev/sdb1

# æ£€æŸ¥å¹¶ä¿®å¤ ext4 æ–‡ä»¶ç³»ç»Ÿ
sudo fsck.ext4 -f /dev/sdb1

# æ£€æŸ¥å¹¶ä¿®å¤ XFS æ–‡ä»¶ç³»ç»Ÿ
sudo xfs_repair /dev/sdb1

# æ£€æŸ¥å¹¶ä¿®å¤ Btrfs æ–‡ä»¶ç³»ç»Ÿ
sudo btrfs check /dev/sdb1
```

:::danger
ç»å¯¹ä¸è¦åœ¨å·²æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿä¸Šè¿è¡Œ `fsck`ï¼è¿™å¯èƒ½å¯¼è‡´ä¸¥é‡çš„æ•°æ®æŸåã€‚å¦‚æœéœ€è¦ä¿®å¤æ ¹åˆ†åŒºï¼Œè¯·ä½¿ç”¨ Live USB å¯åŠ¨åå†æ“ä½œã€‚
:::

### ç£ç›˜è¯»å†™é€Ÿåº¦å¼‚å¸¸

```bash
# ç®€å•æµ‹è¯•ç£ç›˜å†™å…¥é€Ÿåº¦
dd if=/dev/zero of=/tmp/testfile bs=1M count=1024 oflag=direct 2>&1

# ç®€å•æµ‹è¯•ç£ç›˜è¯»å–é€Ÿåº¦
dd if=/tmp/testfile of=/dev/null bs=1M count=1024 iflag=direct 2>&1

# æ¸…ç†æµ‹è¯•æ–‡ä»¶
rm /tmp/testfile

# ä½¿ç”¨ hdparm æµ‹è¯•è¯»å–é€Ÿåº¦
sudo apt install hdparm
sudo hdparm -tT /dev/sda

# æ£€æŸ¥ç£ç›˜ I/O çŠ¶å†µ
sudo apt install sysstat
iostat -x 1 5
```

## ğŸ“ å®ç”¨æŠ€å·§æ±‡æ€»

### å¿«é€Ÿå‚è€ƒ

| ä»»åŠ¡ | å‘½ä»¤ |
|------|------|
| æŸ¥çœ‹æ‰€æœ‰ç£ç›˜ | `lsblk` |
| æŸ¥çœ‹ç£ç›˜ä½¿ç”¨ | `df -h` |
| æŸ¥çœ‹ç›®å½•å¤§å° | `du -sh /path` |
| æŸ¥çœ‹åˆ†åŒº UUID | `sudo blkid` |
| æ ¼å¼åŒ–ä¸º ext4 | `sudo mkfs.ext4 /dev/sdX1` |
| æŒ‚è½½åˆ†åŒº | `sudo mount /dev/sdX1 /mnt/point` |
| å¸è½½åˆ†åŒº | `sudo umount /mnt/point` |
| æµ‹è¯• fstab | `sudo mount -a` |
| æ‰©å±• LVM | `sudo lvextend -L +10G /dev/vg/lv && sudo resize2fs /dev/vg/lv` |
| åˆ›å»º swap æ–‡ä»¶ | `sudo fallocate -l 4G /swapfile` |
| ç£ç›˜å¥åº·æ£€æŸ¥ | `sudo smartctl -H /dev/sda` |
| æ–‡ä»¶ç³»ç»Ÿä¿®å¤ | `sudo fsck /dev/sdX1`ï¼ˆé¡»å…ˆå¸è½½ï¼‰ |

### å®‰å…¨æ“ä½œæ¸…å•

åœ¨è¿›è¡Œç£ç›˜æ“ä½œå‰ï¼Œè¯·æ ¸å¯¹ä»¥ä¸‹äº‹é¡¹ï¼š

1. **å¤‡ä»½æ•°æ®**ï¼šä»»ä½•åˆ†åŒºã€æ ¼å¼åŒ–æ“ä½œå‰ï¼Œç¡®ä¿é‡è¦æ•°æ®å·²å¤‡ä»½
2. **ç¡®è®¤è®¾å¤‡å**ï¼šä½¿ç”¨ `lsblk` åå¤ç¡®è®¤è¦æ“ä½œçš„è®¾å¤‡ï¼Œé¿å…è¯¯æ“ä½œç³»ç»Ÿç›˜
3. **å¸è½½åæ“ä½œ**ï¼šä¿®å¤æ–‡ä»¶ç³»ç»Ÿå‰å¿…é¡»å…ˆå¸è½½
4. **æµ‹è¯• fstab**ï¼šä¿®æ”¹ `/etc/fstab` åä½¿ç”¨ `mount -a` éªŒè¯
5. **ä½¿ç”¨ UUID**ï¼šfstab ä¸­å§‹ç»ˆä½¿ç”¨ UUIDï¼Œä¸ä½¿ç”¨ `/dev/sdX`
6. **ä¿å­˜å¯†ç **ï¼šåŠ å¯†åˆ†åŒºçš„å¯†ç è¦å¦¥å–„ä¿ç®¡

## ä¸‹ä¸€æ­¥

æŒæ¡ç£ç›˜ä¸å­˜å‚¨ç®¡ç†åï¼Œæ‚¨å¯ä»¥ç»§ç»­å­¦ä¹ ï¼š

1. [ç³»ç»ŸæœåŠ¡ç®¡ç†](/administration/services) - ç®¡ç†ç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹å’ŒæœåŠ¡
2. [å®‰å…¨åŠ å›º](/administration/security) - åŠ å¼ºç³»ç»Ÿå®‰å…¨é˜²æŠ¤
3. [æ—¥å¿—ç®¡ç†](/administration/logs) - æŸ¥çœ‹å’Œç®¡ç†ç³»ç»Ÿæ—¥å¿—

---

**ç£ç›˜ç®¡ç†å·²ç»æŒæ¡äº†ï¼Ÿ** [ç»§ç»­å­¦ä¹ ç³»ç»ŸæœåŠ¡ç®¡ç† â†’](/administration/services)
